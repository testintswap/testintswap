"use strict";(self.webpackChunkintswap_frontend=self.webpackChunkintswap_frontend||[]).push([[1227],{11227:(ct,k,a)=>{a.r(k),a.d(k,{LpStakingPoolsModule:()=>pt});var u=a(88692),y=a(7976),x=a(8239),p=a(2024),M=a(92673),A=a(54121),m=a(27969),f=a(61528),I=a(84967),w=a(42147),L=a(15696),O=a(66393),P=a(84945),U=a(62686),S=a(91095),t=a(64537),b=a(19376),B=a(96195),N=a(39869),Z=a(83331),T=a(50132),C=a(13288);function J(n,e){if(1&n&&(t.TgZ(0,"div",7)(1,"h3",8),t._uU(2,"Supported Innovative Reward Strategies"),t.qZA(),t.TgZ(3,"a",9),t._uU(4),t.qZA()()),2&n){const o=t.oxw().$implicit;t.xp6(3),t.Q6J("href",o.link,t.LSH),t.xp6(1),t.Oqu(o.content)}}function Y(n,e){1&n&&t.YNc(0,J,5,2,"ng-template",6)}function Q(n,e){1&n&&(t.TgZ(0,"mat-icon",22),t._uU(1," south"),t.qZA())}function F(n,e){1&n&&(t.TgZ(0,"mat-icon",22),t._uU(1," north"),t.qZA())}function D(n,e){if(1&n&&(t.ynx(0),t.YNc(1,Q,2,0,"mat-icon",21),t.YNc(2,F,2,0,"mat-icon",21),t.BQk()),2&n){const o=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",-1==o.sortBy.sortDirection),t.xp6(1),t.Q6J("ngIf",1==o.sortBy.sortDirection)}}function z(n,e){1&n&&(t.TgZ(0,"mat-icon",22),t._uU(1," south"),t.qZA())}function R(n,e){1&n&&(t.TgZ(0,"mat-icon",22),t._uU(1," north"),t.qZA())}function j(n,e){if(1&n&&(t.ynx(0),t.YNc(1,z,2,0,"mat-icon",21),t.YNc(2,R,2,0,"mat-icon",21),t.BQk()),2&n){const o=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",-1==o.sortBy.sortDirection),t.xp6(1),t.Q6J("ngIf",1==o.sortBy.sortDirection)}}function E(n,e){1&n&&(t.TgZ(0,"div",23),t._uU(1,"loading..."),t.qZA())}function q(n,e){1&n&&(t.TgZ(0,"div",23),t._uU(1,"No Data."),t.qZA())}function H(n,e){1&n&&(t.TgZ(0,"mat-icon",34),t._uU(1," emoji_events"),t.qZA())}function G(n,e){if(1&n&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const o=e.ngIf;t.xp6(1),t.AsE(" ",o.name," : ",t.xi3(2,2,o.apy,"1.2-8")," % ")}}function V(n,e){1&n&&t._uU(0," loading Item ... ")}function W(n,e){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,G,3,5,"div",36),t.ALo(2,"async"),t.YNc(3,V,1,0,"ng-template",null,38,t.W1O),t.qZA()),2&n){const o=e.$implicit,i=t.MAs(4);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,o))("ngIfElse",i)}}function K(n,e){if(1&n&&(t.ynx(0),t.YNc(1,W,5,4,"div",4),t.BQk()),2&n){const o=e.ngIf;t.xp6(1),t.Q6J("ngForOf",o)}}function X(n,e){1&n&&t._uU(0," loading ")}function tt(n,e){if(1&n&&(t.TgZ(0,"div",35),t.YNc(1,K,2,1,"ng-container",36),t.ALo(2,"async"),t.YNc(3,X,1,0,"ng-template",null,37,t.W1O),t.qZA()),2&n){const o=t.MAs(4),i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,i.strategyApys$))("ngIfElse",o)}}const nt=function(n){return["/","app","lp-staking-pool",n]};function ot(n,e){if(1&n&&(t.TgZ(0,"div",24)(1,"div",25)(2,"div",26),t._UZ(3,"img",27)(4,"img",28),t.qZA(),t._uU(5),t.YNc(6,H,2,0,"mat-icon",29),t.qZA(),t.TgZ(7,"div",30),t._uU(8),t.ALo(9,"number"),t.ALo(10,"async"),t.qZA(),t.TgZ(11,"div",31),t._uU(12),t.ALo(13,"number"),t.ALo(14,"async"),t.TgZ(15,"mat-icon",32),t._uU(16,"help "),t.qZA()(),t.TgZ(17,"div",17),t._uU(18),t.qZA(),t.TgZ(19,"div",18),t._uU(20),t.ALo(21,"async"),t.qZA(),t.YNc(22,tt,5,4,"ng-template",null,33,t.W1O),t.qZA()),2&n){const o=e.$implicit,i=t.MAs(23),s=t.oxw(2);t.Q6J("routerLink",t.VKq(23,nt,o.pairAddress)),t.xp6(3),t.Q6J("src",s.getTokenIcon(o.pair.collection.address),t.LSH),t.xp6(1),t.Q6J("src",s.getTokenIcon(o.pair.token.address),t.LSH),t.xp6(1),t.hij(" ",o.pairName," "),t.xp6(1),t.Q6J("ngIf",s.isTestnetPair(o.pairAddress)),t.xp6(2),t.hij("$ ",t.xi3(9,11,o.tvl||t.lcZ(10,14,o.tvl$)||0,"1.2-8"),""),t.xp6(4),t.hij("",t.xi3(13,16,o.totalApy||t.lcZ(14,19,o.totalApy$)||0,"1.2-8")," % "),t.xp6(3),t.Q6J("nzPopoverArrowPointAtCenter",!0)("nzPopoverContent",i),t.xp6(3),t.hij("",o.stakedRatio," %"),t.xp6(2),t.hij("$ ",t.lcZ(21,21,o.userStaked$),"")}}function et(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"div",13),t._uU(4,"NAME"),t.qZA(),t.TgZ(5,"div",14),t.NdJ("click",function(){const c=t.CHM(o).ngIf,l=t.oxw();return t.KtG(l.changeSortDirection("tvl",c.sortBy))}),t._uU(6,"TVL "),t.YNc(7,D,3,2,"ng-container",15),t.qZA(),t.TgZ(8,"div",16),t.NdJ("click",function(){const c=t.CHM(o).ngIf,l=t.oxw();return t.KtG(l.changeSortDirection("apy",c.sortBy))}),t._uU(9,"Total APY "),t.YNc(10,j,3,2,"ng-container",15),t.qZA(),t.TgZ(11,"div",17),t._uU(12,"Total Staked Ratio"),t.qZA(),t.TgZ(13,"div",18),t._uU(14,"Your Staked"),t.qZA()(),t.YNc(15,E,2,0,"div",19),t.YNc(16,q,2,0,"div",19),t.YNc(17,ot,24,25,"div",20),t.qZA()()}if(2&n){const o=e.ngIf;t.xp6(7),t.Q6J("ngIf",o.sortBy&&"tvl"==o.sortBy.sortBy),t.xp6(3),t.Q6J("ngIf",o.sortBy&&"apy"==o.sortBy.sortBy),t.xp6(5),t.Q6J("ngIf",!o.lpStakingPoolList),t.xp6(1),t.Q6J("ngIf",!!o.lpStakingPoolList&&0==o.lpStakingPoolList.length),t.xp6(1),t.Q6J("ngForOf",o.lpStakingPoolList)}}const it=function(){return{delay:3e3,disableOnInteraction:!1}},rt=function(n,e){return{lpStakingPoolList:n,sortBy:e}};S.ZP.use([S.tl,S.pt]);const at=[{path:"",component:(()=>{class n{constructor(o,i,s){var c=this;this.cacheService=o,this.web3Service=i,this.graphqlService=s,this.strategyBannerList=[{content:"Fixed Reward Rate Strategy",link:"https://docs.intswap.io/getting-started-with-intswap/lp-mining"},{content:"Royalty Distribution Strategy",link:"https://docs.intswap.io/getting-started-with-intswap/lp-mining"},{content:"NFT Buying Incentive Strategy",link:"https://docs.intswap.io/getting-started-with-intswap/lp-mining"}],this.sortBy$=new A.X({sortBy:"tvl",sortDirection:-1}),this.showOnlyUserStaked$=new A.X(!1),this.lpStakingPoolList$=this.cacheService.pairList$.pipe((0,m.U)(l=>l.map(r=>{const g=p.O$.from(r.lpStakingPool.totalStakingAmount).mul(p.O$.from("10000")).div(p.O$.from(r.liquidity)).toNumber()/100,v=this.cacheService.ethPrice$.pipe((0,m.U)(d=>p.O$.from(d).mul(p.O$.from(r.tvl)).mul(p.O$.from(parseInt(100*g+""))).div(p.O$.from("10").pow(30)).toString())),_=v.pipe((0,f.w)(function(){var d=(0,x.Z)(function*(h){return yield c.getApy0fStrategies(r,h)});return function(h){return d.apply(this,arguments)}}())),st=_.pipe((0,f.w)(d=>(0,I.D)(d))).pipe((0,m.U)(d=>this.sumApy(d)),(0,w.x)((d,h)=>d==h)),$=r.lpStakingPool.userStaking.length>0&&p.O$.from(r.lpStakingPool.userStaking[0].amount).gt(p.O$.from("0"));return{pairAddress:r.address,pairName:r.collection.symbol+" - "+r.token.symbol,pair:r,totalApy$:st,stakedRatio:g,tvl$:v,strategyApys$:_,isUserStaked:$,userStaked$:v.pipe((0,m.U)(d=>$?p.O$.from(r.lpStakingPool.userStaking[0].amount).mul(p.O$.from(d)).div(p.O$.from(r.lpStakingPool.totalStakingAmount)).toString():"0"))}}))),this.filterLpStakingPoolList$=this.showOnlyUserStaked$.pipe((0,f.w)(l=>this.lpStakingPoolList$.pipe((0,m.U)(r=>r.filter(g=>!l||g.isUserStaked))))),this.sortLpStakingPoolList$=this.filterLpStakingPoolList$.pipe((0,f.w)(l=>this.sortList(l)))}ngOnInit(){}sortList(o){if(o){const i=o.map(s=>s.totalApy$.pipe((0,m.U)(c=>({...s,totalApy:c}))).pipe((0,f.w)(c=>c.tvl$.pipe((0,m.U)(l=>({...c,tvl:l}))))));return this.sortBy$.pipe((0,f.w)(({sortBy:s,sortDirection:c})=>{switch(s){case"apy":return(0,L.a)(i).pipe((0,m.U)(l=>l.sort((r,g)=>c*(r.totalApy-g.totalApy))));case"tvl":return(0,L.a)(i).pipe((0,m.U)(l=>l.sort((r,g)=>c*(parseFloat(r.tvl)>parseFloat(g.tvl)?1:-1))))}}))}return(0,O.D)([])}sumApy(o){let i=0;for(let s=0;s<o.length;s++)i+=o[s].apy;return i}changeSortDirection(o,i){i&&this.sortBy$.next({sortBy:o,sortDirection:o==i.sortBy?-1*i.sortDirection:-1})}getGlobalStrategies(){return this.cacheService.getGlobalStrategies()}getApy0fStrategies(o,i){var s=this;return(0,x.Z)(function*(){return[...yield s.getGlobalStrategies(),...o.lpStakingPool.incentiveStrategyList].map(c=>{if(c.status){const l=s.getStrategyRewardRate(o.address,c.address);return l&&p.O$.from(i).gt(p.O$.from(0))?l.pipe((0,m.U)(r=>({name:c.name,apy:p.O$.from(r.value).mul(p.O$.from("10000")).div(p.O$.from(10).pow(r.decimals)).div(p.O$.from(i)).toNumber()/100})),(0,w.x)((r,g)=>r==g)):l&&p.O$.from(i).eq(p.O$.from(0))?(0,P.of)({name:c.name,apy:1/0}):(0,P.of)({name:c.name,apy:0})}return(0,P.of)({name:c.name,apy:0})})})()}getStrategyRewardRate(o,i){var s=this;return(0,O.D)(this.web3Service.invokeContract("IIntswapV1IncentiveStrategy","estimatedOneYearRewards",[o],i)).pipe((0,f.w)(function(){var c=(0,x.Z)(function*(l){const r=l[0];if(r==U.je)return{value:"0",decimals:18};const g=l[1],v=(0,M.parseUnits)(yield s.cacheService.fetchRewardTokenPrice(r),"4"),_=(yield s.web3Service.getTokenDecimals(r).catch(()=>({0:18})))[0];return{value:p.O$.from(g).mul(v).div(p.O$.from("10000")).toString(),decimals:_}});return function(l){return c.apply(this,arguments)}}()))}isTestnetPair(o){return["0x9FbAC0d7235809caC1fE0535096f4d45A2CBBe12","0xEcC79aF1ab1923a2DFEFcE705228C86029567129","0xa48649E328158d5867072c54d725C218550A1009","0x7C2917E9cC0635E23A4ACd55D0A2C0cCfE19E029","0x36aA5CD15aa12D953C973A792D4837aF61d65f24"].map(i=>i.toLowerCase()).includes(o.toLowerCase())}getTokenIcon(o){return this.cacheService.getTokenIcon(o)}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(b.Q),t.Y36(B.U),t.Y36(N.J))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-lp-staking-pools"]],decls:10,vars:15,consts:[[2,"margin","1rem auto","width","80vw","display","grid","grid-template-columns","1fr 1fr","padding","1rem","column-gap","2rem"],[2,"font-size","3rem","font-weight","bolder","grid-column-start","span 2"],[2,"justify-self","center","align-self","center","font-size","1rem","line-height","1.5","padding-right","3rem"],["direction","vertical",2,"width","35vw","height","15vh","justify-self","center","align-items","center",3,"loop","autoplay","pagination","slidesPerView","spaceBetween"],[4,"ngFor","ngForOf"],["class","lp-pools-wrapper",4,"ngIf"],["swiperSlide","","data-swiper-autoplay","8000"],[1,"strategy-banner-item"],[2,"margin-bottom","1rem"],["target","_blank",2,"font-size","2rem","font-weight","bolder","text-decoration","underline",3,"href"],[1,"lp-pools-wrapper"],[1,"lp-pools-list"],[1,"lp-pool-header"],[1,"lp-pool-name"],[1,"lp-pool-tvl",2,"cursor","pointer",3,"click"],[4,"ngIf"],[1,"lp-pool-total-apy",2,"cursor","pointer",3,"click"],[1,"lp-pool-staked-ratio"],[1,"lp-pool-user-staked"],["class","lp-pool-loading",4,"ngIf"],["class","lp-pool-item",3,"routerLink",4,"ngFor","ngForOf"],["color","primary",4,"ngIf"],["color","primary"],[1,"lp-pool-loading"],[1,"lp-pool-item",3,"routerLink"],[1,"lp-pool-name",2,"justify-content","start","padding-left","2rem"],[2,"margin-right","12px"],[2,"z-index","3","width","28px","height","28px","border-radius","50%","margin","0 -6px","position","relative",3,"src"],[2,"z-index","2","width","28px","height","28px","border-radius","50%","margin","0 -6px","position","relative",3,"src"],["style","font-size: 14px;color: gold;height: 14px;line-height: 14px;animation: changeColor 1.2s infinite linear;",4,"ngIf"],[1,"lp-pool-tvl"],[1,"lp-pool-total-apy"],["color","primary","nz-popover","","nzPopoverPlacement","rightTop",3,"nzPopoverArrowPointAtCenter","nzPopoverContent"],["apyDetail",""],[2,"font-size","14px","color","gold","height","14px","line-height","14px","animation","changeColor 1.2s infinite linear"],[2,"min-height","10vh","min-width","15vw"],[4,"ngIf","ngIfElse"],["loading",""],["loadingItem",""]],template:function(o,i){1&o&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"NFT LP Mining"),t.qZA(),t.TgZ(3,"p",2),t._uU(4,"Provide liquidity for your favorite NFT Pool in Intswap, and get corresponding rewards according to various reward strategies. Put forward your new ideas in the community, we will give rich rewards."),t.qZA(),t.TgZ(5,"swiper",3),t.YNc(6,Y,1,0,null,4),t.qZA()(),t.YNc(7,et,18,5,"div",5),t.ALo(8,"async"),t.ALo(9,"async")),2&o&&(t.xp6(5),t.Q6J("loop",!1)("autoplay",t.DdM(11,it))("pagination",!0)("slidesPerView",1)("spaceBetween",0),t.xp6(1),t.Q6J("ngForOf",i.strategyBannerList),t.xp6(1),t.Q6J("ngIf",t.WLB(12,rt,t.lcZ(8,7,i.sortLpStakingPoolList$),t.lcZ(9,9,i.sortBy$))))},dependencies:[u.sg,u.O5,y.rH,Z.Hw,T.lU,C.nF,C.YC,u.Ov,u.JJ],styles:[".lp-pools-wrapper[_ngcontent-%COMP%]{width:80vw;min-height:40vh;border-radius:16px;background:rgba(35,1,33,.3);border:3px solid rgba(97,84,94,.3098039216);-webkit-backdrop-filter:blur(12px) brightness(1.5);backdrop-filter:blur(12px) brightness(1.5);margin:1rem auto;padding:12px}.lp-pools-list[_ngcontent-%COMP%]{width:100%}.lp-pool-loading[_ngcontent-%COMP%]{width:100%;margin-bottom:4px;height:40px;display:flex;align-items:center;justify-content:center}.lp-pool-header[_ngcontent-%COMP%], .lp-pool-item[_ngcontent-%COMP%]{width:100%;margin-bottom:4px;height:40px;display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr;font-weight:700}.lp-pool-header[_ngcontent-%COMP%]   .lp-pool-name[_ngcontent-%COMP%], .lp-pool-header[_ngcontent-%COMP%]   .lp-pool-total-apy[_ngcontent-%COMP%], .lp-pool-header[_ngcontent-%COMP%]   .lp-pool-staked-ratio[_ngcontent-%COMP%], .lp-pool-header[_ngcontent-%COMP%]   .lp-pool-user-staked[_ngcontent-%COMP%], .lp-pool-header[_ngcontent-%COMP%]   .lp-pool-tvl[_ngcontent-%COMP%], .lp-pool-item[_ngcontent-%COMP%]   .lp-pool-name[_ngcontent-%COMP%], .lp-pool-item[_ngcontent-%COMP%]   .lp-pool-total-apy[_ngcontent-%COMP%], .lp-pool-item[_ngcontent-%COMP%]   .lp-pool-staked-ratio[_ngcontent-%COMP%], .lp-pool-item[_ngcontent-%COMP%]   .lp-pool-user-staked[_ngcontent-%COMP%], .lp-pool-item[_ngcontent-%COMP%]   .lp-pool-tvl[_ngcontent-%COMP%]{padding:0 12px;width:100%;height:100%;display:flex;justify-content:center;align-items:center}.lp-pool-name[_ngcontent-%COMP%]{min-width:30vw}.lp-pool-header[_ngcontent-%COMP%]{font-weight:bolder;height:48px;font-size:18px;border-radius:4px}.lp-pool-item[_ngcontent-%COMP%]{border-radius:4px;border:1px solid rgba(255,216,237,.4);cursor:pointer}.lp-pool-item[_ngcontent-%COMP%]:hover{background:rgba(255,213,168,.2)}.lp-pool-item[_ngcontent-%COMP%]   .lp-pool-total-apy[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-left:12px;height:18px;width:18px;font-size:18px;cursor:pointer}.strategy-banner-item[_ngcontent-%COMP%]{width:35vw;height:15vh;border-radius:1rem;border:2px solid rgba(255,154,231,.3098039216);display:flex;flex-direction:column;justify-content:center;align-items:center}@keyframes changeColor{0%{color:gold}25%{color:#0ff}50%{color:#0f2}75%{color:#fffb00}to{color:gold}}"]}),n})()}];let lt=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[y.Bz.forChild(at),y.Bz]}),n})(),pt=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.ez,lt,Z.Ps,T.$6,C.kz]}),n})()}}]);