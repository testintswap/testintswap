"use strict";(self.webpackChunkintswap_frontend=self.webpackChunkintswap_frontend||[]).push([[3887],{43887:(H,y,r)=>{r.r(y),r.d(y,{CreatorModule:()=>j});var u=r(88692),p=r(7976),v=r(8239),x=r(9375),b=r(2024),C=r(92673),w=r(23815),R=r(61528),P=r(57445),A=r(41781),t=r(64537),O=r(19376),M=r(94602),k=r(96195),I=r(39869),Z=r(87668);function U(n,l){1&n&&(t.TgZ(0,"div",4)(1,"div",5)(2,"p"),t._uU(3,"The Creator's functions are now for invited members only. If you are interested, please watch our "),t.TgZ(4,"a",6),t._uU(5,"tutorial video"),t.qZA(),t._uU(6," or join our "),t.TgZ(7,"a",7),t._uU(8,"discord"),t.qZA(),t._uU(9," and contact admin."),t.qZA()()())}const S=function(n){return["/","app","priceRange",n]},V=function(n){return["/","app","royaltyRatio",n]},L=function(n){return["/","app","royaltyRewardRatio",n]};function z(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",4)(1,"div",8),t._uU(2),t.qZA(),t.TgZ(3,"div",9)(4,"div",10)(5,"div",11),t._UZ(6,"img",12)(7,"img",12),t.qZA(),t.TgZ(8,"h1"),t._uU(9),t.qZA()(),t.TgZ(10,"span",13),t._uU(11,"Current Price"),t.qZA(),t.TgZ(12,"span",14),t._uU(13),t.ALo(14,"number"),t.qZA(),t.TgZ(15,"span",13),t._uU(16,"Price Range"),t.qZA(),t.TgZ(17,"span",14),t._uU(18),t.ALo(19,"number"),t.ALo(20,"number"),t.qZA(),t.TgZ(21,"span",13),t._uU(22,"Royalty Ratio"),t.qZA(),t.TgZ(23,"span",14),t._uU(24),t.ALo(25,"number"),t.qZA(),t.TgZ(26,"span",13),t._uU(27,"Royalty Reward Ratio"),t.qZA(),t.TgZ(28,"span",14),t._uU(29),t.ALo(30,"number"),t.qZA(),t.TgZ(31,"span",13),t._uU(32,"Pending Royalty"),t.qZA(),t.TgZ(33,"span",14),t._uU(34),t.ALo(35,"number"),t.qZA(),t.TgZ(36,"button",15),t._uU(37,"Revise"),t.qZA(),t.TgZ(38,"button",16),t._uU(39,"Revise"),t.qZA(),t.TgZ(40,"button",17),t._uU(41,"Revise"),t.qZA(),t.TgZ(42,"button",18),t.NdJ("click",function(){const s=t.CHM(e).$implicit,f=t.oxw(2);return t.KtG(f.claimRoyalty(s))}),t._uU(43,"Claim"),t.qZA()(),t._UZ(44,"div",19),t.TgZ(45,"h2",20),t._uU(46,"Volume and Price"),t.qZA(),t.TgZ(47,"div",21),t.NdJ("chartInit",function(c){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onChartInit(c))}),t.qZA()()}if(2&n){const e=l.$implicit,o=l.index,c=t.oxw(2);t.xp6(2),t.Oqu(o+1),t.xp6(4),t.Q6J("src",c.getTokenIcon(e.collection.address),t.LSH)("alt",e.collection.name),t.xp6(1),t.Q6J("src",c.getTokenIcon(e.token.address),t.LSH)("alt",e.token.name),t.xp6(2),t.AsE("",e.collection.name," - ",e.token.name,""),t.xp6(4),t.AsE("",t.xi3(14,19,c.formatTokenValue(e.price,"18"),"1.2-4")," ",e.token.symbol,""),t.xp6(5),t.AsE("",t.xi3(19,22,c.formatTokenValue(e.minPrice,"18"),"1.2-4")," - ",t.xi3(20,25,c.formatTokenValue(e.maxPrice,"18"),"1.2-4"),""),t.xp6(6),t.hij("",t.xi3(25,28,e.royaltyRatio,"1.2-4")," %"),t.xp6(5),t.hij("",t.xi3(30,31,e.royaltyRewardRatio,"1.2-4")," %"),t.xp6(5),t.AsE("",t.xi3(35,34,c.formatTokenValue(e.pendingRoyalty,"18"),"1.2-4")," ",e.token.symbol,""),t.xp6(2),t.Q6J("routerLink",t.VKq(37,S,e.address)),t.xp6(2),t.Q6J("routerLink",t.VKq(39,V,e.address)),t.xp6(2),t.Q6J("routerLink",t.VKq(41,L,e.address)),t.xp6(7),t.Q6J("options",e.chartOption)}}function _(n,l){if(1&n&&(t.ynx(0),t.YNc(1,U,10,0,"div",2),t.YNc(2,z,48,43,"div",3),t.BQk()),2&n){const e=l.ngIf,o=t.oxw();t.xp6(1),t.Q6J("ngIf",e&&0==e.length),t.xp6(1),t.Q6J("ngForOf",e)("ngForTrackBy",o.trackByPairAddress)}}let J=(()=>{class n{constructor(e,o,c,s,f){var d=this;this.cacheService=e,this.accountService=o,this.web3Service=c,this.graphqlService=s,this.router=f,this.creatorOfPairs$=this.accountService.account$.pipe((0,R.w)(m=>this.cacheService.fetchPairsByCreator(m).pipe((0,R.w)(function(){var h=(0,v.Z)(function*(g){return yield Promise.all(g.map(function(){var i=(0,v.Z)(function*(a){return{...a,pendingRoyalty:yield d.fetchPendingRoyalty(a.address),royaltyRatio:yield d.fetchRoyaltyRatio(a.address),royaltyRewardRatio:yield d.fetchRewardRoyaltyRatio(a.address),chartOption:yield d.fetchHourData(a)}});return function(a){return i.apply(this,arguments)}}()))});return function(g){return h.apply(this,arguments)}}()))))}fetchPendingRoyalty(e){return this.web3Service.invokeContract("IntswapV1RoyaltyVault","claimRecords",[e]).then(o=>o[0])}fetchRoyaltyRatio(e){return this.web3Service.invokeContract("IntswapV1Factory","getRoyaltyInfo",[e]).then(o=>o[1]/10**16+"")}fetchRewardRoyaltyRatio(e){return this.web3Service.invokeContract("IntswapV1RoyaltyVault","getRoyaltyRewardRatio",[e]).then(o=>o[0]/10**16+"").catch(()=>"0")}claimRoyalty(e){b.O$.from(e.pendingRoyalty).gt(b.O$.from("0"))&&this.web3Service.invokeContract("IntswapV1CreatorManager","applyWithdrawRoyalty",[e.address,e.pendingRoyalty,"Request Withdraw Royalty",`Withdraw Royalty ${(0,C.formatUnits)(e.pendingRoyalty,"18")} ${e.token.symbol}.`]).then(()=>{this.router.navigate(["app/proposal/",e.address])})}ngOnInit(){}onChartInit(e){this.echartsInstance=e}trackByPairAddress(e,o){return o.address}resizeChart(){this.echartsInstance&&this.echartsInstance.resize()}formatTokenValue(e,o){return(0,C.formatUnits)(e,o)}fetchHourData(e){return(0,P.z)(this.graphqlService.fetchHourData(e.address)).then(({data:o})=>{if(o.pair){const c=(o=(0,w.cloneDeep)(o)).pair.hourData.sort((i,a)=>parseInt(i.hourStartTime)-parseInt(a.hourStartTime)),s=c.length>0?(0,A.oC)(c.map(i=>parseInt(i.hourStartTime))[0]):[];let f;const d=s.map(i=>{let a=c.find(q=>parseInt(q.hourStartTime)==i);return a?f=a:(a=f,a.volume="0"),a}),m=d.map(i=>this.formatTokenValue(i.price,e.token.decimals||"18")),h=d.map(i=>this.formatTokenValue(i.volume,e.token.decimals||"18")),g=(0,w.cloneDeep)(T);return g.series[0].data=m.map((i,a)=>[new Date(1e3*s[a]),i]),g.series[1].data=h.map((i,a)=>[new Date(1e3*s[a]),i]),g.tooltip.valueFormatter=i=>parseFloat(i).toFixed(8)+" "+e?.token.symbol,g}return T})}getTokenIcon(e){return this.cacheService.getTokenIcon(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(O.Q),t.Y36(M.B),t.Y36(k.U),t.Y36(I.J),t.Y36(p.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-creator"]],decls:3,vars:3,consts:[[1,"creator-wrapper"],[4,"ngIf"],["class","creator-collection-card",4,"ngIf"],["class","creator-collection-card",4,"ngFor","ngForOf","ngForTrackBy"],[1,"creator-collection-card"],[2,"width","100%","height","20vh","display","flex","align-items","center","font-size","1rem","font-weight","bold","padding","2rem 5rem"],["href","https://youtu.be/c5fgo-UQN9o","target","_blank"],["href","https://discord.gg/cvPJAz2Bms","target","_blank"],[1,"collection-no"],[1,"collection-info"],[1,"collection-logo"],[1,"logo-imgs"],[3,"src","alt"],[1,"collection-info-item-label"],[1,"collection-info-item-value"],[1,"revise-interval-btn",3,"routerLink"],[1,"revise-royalty-btn",3,"routerLink"],[1,"revise-royalty-reward-btn",3,"routerLink"],[1,"claim-royalty-btn",3,"click"],[1,"divider"],[2,"text-align","center"],["echarts","",1,"collection-chart",3,"options","chartInit"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,_,3,3,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,o.creatorOfPairs$)))},dependencies:[u.sg,u.O5,p.rH,Z._w,u.Ov,u.JJ],styles:[".creator-wrapper[_ngcontent-%COMP%]{padding:12px 10%;width:100vw;box-sizing:border-box}.creator-collection-card[_ngcontent-%COMP%]{position:relative;background:rgba(35,1,33,.3);border:3px solid rgba(97,84,94,.3098039216);-webkit-backdrop-filter:blur(12px) brightness(1.5);backdrop-filter:blur(12px) brightness(1.5);padding:12px 24px;min-height:40vh;border-radius:8px;box-shadow:0 2px 4px -1px #0003;box-sizing:border-box;width:100%;margin-bottom:24px}.collection-no[_ngcontent-%COMP%]{width:36px;height:36px;display:flex;justify-content:center;align-items:center;position:absolute;right:12px;top:12px;font-size:24px;font-weight:bolder;color:#fff;border-radius:50%;background:linear-gradient(45deg,#f9d4af 0%,#ffb6db 100%)}.collection-info[_ngcontent-%COMP%]{width:90%;min-height:30vh;box-sizing:border-box;padding:12px;display:grid;grid-template-columns:360px 1fr 1fr 120px;grid-template-rows:1fr 1fr 1fr 1fr 1fr;column-gap:24px;align-items:center}.collection-logo[_ngcontent-%COMP%]{width:100%;grid-row-start:span 5;display:flex;justify-content:center;align-items:center;flex-direction:column}.collection-logo[_ngcontent-%COMP%]   .logo-imgs[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:row;margin-bottom:24px}.collection-logo[_ngcontent-%COMP%]   .logo-imgs[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{z-index:1}.collection-logo[_ngcontent-%COMP%]   .logo-imgs[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:180px;width:180px;margin:0 -12px;border-radius:50%;background:linear-gradient(180deg,#fceeff 0%,#fff5d4 100%);border:1px solid rgb(242,174,197)}.collection-info-item-label[_ngcontent-%COMP%]{grid-column-start:2;grid-column-end:3;padding-left:48px;font-size:18px;color:#680063}.collection-info-item-value[_ngcontent-%COMP%]{justify-self:end;font-size:18px;grid-column-start:3;grid-column-end:4}.revise-interval-btn[_ngcontent-%COMP%]{grid-row-start:2;grid-row-end:3}.revise-royalty-btn[_ngcontent-%COMP%]{grid-row-start:3;grid-row-end:4}.revise-royalty-reward-btn[_ngcontent-%COMP%]{grid-row-start:4;grid-row-end:5}.claim-royalty-btn[_ngcontent-%COMP%]{grid-row-start:5;grid-row-end:6}.revise-interval-btn[_ngcontent-%COMP%], .revise-royalty-reward-btn[_ngcontent-%COMP%], .revise-royalty-btn[_ngcontent-%COMP%], .claim-royalty-btn[_ngcontent-%COMP%]{grid-column-start:4;width:120px;height:36px;border-radius:16px;background:linear-gradient(45deg,#ff64b2 0%,#ffa852 100%);color:#fff;font-size:14px;font-weight:bolder;display:flex;justify-content:center;align-items:center;transition:all .2s;cursor:pointer;z-index:1;border:none}.revise-interval-btn[_ngcontent-%COMP%]:hover, .revise-royalty-btn[_ngcontent-%COMP%]:hover, .revise-royalty-reward-btn[_ngcontent-%COMP%]:hover, .claim-royalty-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(45deg,#fda7d2 0%,#f8cda2 100%);color:#5a4c58}.divider[_ngcontent-%COMP%]{height:1px;width:100%;margin:8px 0 32px;background:linear-gradient(90deg,#f3b8ff 0%,#afeeff 100%)}.collection-chart[_ngcontent-%COMP%]{height:280px}"]}),n})();const T={tooltip:{show:!0,trigger:"axis"},legend:{},grid:{left:"5%",right:"5%",bottom:"15%",top:"25%",containLabel:!0},xAxis:{type:"time",boundaryGap:!1,axisLabel:{show:!1},axisTick:{show:!1},data:[]},yAxis:[{type:"value",name:"Price",show:!1},{type:"value",name:"Volume",show:!1}],series:[{name:"Price",type:"line",symbol:"none",sampling:"lttb",itemStyle:{color:"#ffb6db"},areaStyle:{color:new x.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#ffb6db"},{offset:1,color:"#f9d4af"}])},data:[]},{name:"Volume",type:"line",yAxisIndex:1,symbol:"none",sampling:"lttb",itemStyle:{color:"#f1a6ff"},areaStyle:{color:new x.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#f1a6ff"},{offset:1,color:"#cef0ff"}])},data:[]}]},F=[{path:"",component:J}];let B=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.Bz.forChild(F),p.Bz]}),n})();var Q=r(83331),D=r(83114);let j=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.ez,B,D.H0,Z.Ns.forRoot({echarts:()=>Promise.resolve().then(r.bind(r,9375))}),Q.Ps]}),n})()}}]);