"use strict";(self.webpackChunkintswap_frontend=self.webpackChunkintswap_frontend||[]).push([[3887],{43887:($,h,r)=>{r.r(h),r.d(h,{CreatorModule:()=>H});var f=r(88692),m=r(7976),x=r(8239),v=r(9375),C=r(2024),b=r(92673),w=r(23815),P=r(61528),A=r(57445),O=r(41781),t=r(64537),M=r(19376),T=r(94602),I=r(96195),k=r(39869),Z=r(87668);function U(e,c){1&e&&(t.TgZ(0,"div",4),t._uU(1,"Your Collection Pools are not created yet."),t.qZA())}const V=function(e){return["/","app","priceRange",e]},S=function(e){return["/","app","royaltyRatio",e]},z=function(e){return["/","app","royaltyRewardRatio",e]};function J(e,c){if(1&e){const o=t.EpF();t.TgZ(0,"div",4)(1,"div",5),t._uU(2),t.qZA(),t.TgZ(3,"div",6)(4,"div",7)(5,"div",8),t._UZ(6,"img",9)(7,"img",9),t.qZA(),t.TgZ(8,"h1"),t._uU(9),t.qZA()(),t.TgZ(10,"span",10),t._uU(11,"Current Price"),t.qZA(),t.TgZ(12,"span",11),t._uU(13),t.ALo(14,"number"),t.qZA(),t.TgZ(15,"span",10),t._uU(16,"Price Range"),t.qZA(),t.TgZ(17,"span",11),t._uU(18),t.ALo(19,"number"),t.ALo(20,"number"),t.qZA(),t.TgZ(21,"span",10),t._uU(22,"Royalty Ratio"),t.qZA(),t.TgZ(23,"span",11),t._uU(24),t.ALo(25,"number"),t.qZA(),t.TgZ(26,"span",10),t._uU(27,"Royalty Reward Ratio"),t.qZA(),t.TgZ(28,"span",11),t._uU(29),t.ALo(30,"number"),t.qZA(),t.TgZ(31,"span",10),t._uU(32,"Pending Royalty"),t.qZA(),t.TgZ(33,"span",11),t._uU(34),t.ALo(35,"number"),t.qZA(),t.TgZ(36,"button",12),t._uU(37,"Revise"),t.qZA(),t.TgZ(38,"button",13),t._uU(39,"Revise"),t.qZA(),t.TgZ(40,"button",14),t._uU(41,"Revise"),t.qZA(),t.TgZ(42,"button",15),t.NdJ("click",function(){const l=t.CHM(o).$implicit,d=t.oxw(2);return t.KtG(d.claimRoyalty(l))}),t._uU(43,"Claim"),t.qZA()(),t._UZ(44,"div",16),t.TgZ(45,"h2",17),t._uU(46,"Volume and Price"),t.qZA(),t.TgZ(47,"div",18),t.NdJ("chartInit",function(i){t.CHM(o);const l=t.oxw(2);return t.KtG(l.onChartInit(i))}),t.qZA()()}if(2&e){const o=c.$implicit,n=c.index,i=t.oxw(2);t.xp6(2),t.Oqu(n+1),t.xp6(4),t.s9C("alt",o.collection.name),t.xp6(1),t.s9C("alt",o.token.name),t.xp6(2),t.AsE("",o.collection.name," - ",o.token.name,""),t.xp6(4),t.AsE("",t.xi3(14,19,i.formatTokenValue(o.price,"18"),"1.2-2")," ",o.token.symbol,""),t.xp6(5),t.HOy("",t.xi3(19,22,i.formatTokenValue(o.minPrice,"18"),"1.2-2")," ",o.token.symbol," - ",t.xi3(20,25,i.formatTokenValue(o.maxPrice,"18"),"1.2-2")," ",o.token.symbol,""),t.xp6(6),t.hij("",t.xi3(25,28,o.royaltyRatio,"1.2-2")," %"),t.xp6(5),t.hij("",t.xi3(30,31,o.royaltyRewardRatio,"1.2-2")," %"),t.xp6(5),t.AsE("",t.xi3(35,34,i.formatTokenValue(o.royalty,"18"),"1.2-2")," ",o.token.symbol,""),t.xp6(2),t.Q6J("routerLink",t.VKq(37,V,o.address)),t.xp6(2),t.Q6J("routerLink",t.VKq(39,S,o.address)),t.xp6(2),t.Q6J("routerLink",t.VKq(41,z,o.address)),t.xp6(7),t.Q6J("options",o.chartOption)}}function L(e,c){if(1&e&&(t.ynx(0),t.YNc(1,U,2,0,"div",2),t.YNc(2,J,48,43,"div",3),t.BQk()),2&e){const o=c.ngIf,n=t.oxw();t.xp6(1),t.Q6J("ngIf",o&&0==o.length),t.xp6(1),t.Q6J("ngForOf",o)("ngForTrackBy",n.trackByPairAddress)}}let j=(()=>{class e{constructor(o,n,i,l){var d=this;this.cacheService=o,this.accountService=n,this.web3Service=i,this.graphqlService=l,this.creatorOfPairs$=this.accountService.account$.pipe((0,P.w)(p=>this.cacheService.fetchPairsByCreator(p).pipe((0,P.w)(function(){var y=(0,x.Z)(function*(u){return yield Promise.all(u.map(function(){var g=(0,x.Z)(function*(a){return{...a,royaltyRatio:yield d.fetchRoyaltyRatio(a.address),royaltyRewardRatio:yield d.fetchRewardRoyaltyRatio(a.address),chartOption:yield d.fetchHourData(a)}});return function(a){return g.apply(this,arguments)}}()))});return function(u){return y.apply(this,arguments)}}()))))}fetchRoyaltyRatio(o){return this.web3Service.invokeContract("IntswapV1Factory","getRoyaltyInfo",[o]).then(n=>n[1]/10**16+"")}fetchRewardRoyaltyRatio(o){return this.web3Service.invokeContract("IntswapV1RoyaltyVault","getRoyaltyRewardRatio",[o]).then(n=>n[0]/10**16+"").catch(()=>"0")}claimRoyalty(o){C.O$.from(o.royalty).gt(C.O$.from("0"))&&this.web3Service.invokeContract("IntswapV1CreatorManager","applyWithdrawRoyalty",[o.address,o.royalty,"Request Withdraw Royalty",`Withdraw Royalty ${(0,b.formatUnits)(o.royalty,"18")} ${o.token.symbol}.`]).then(n=>n[1]/10**18+"")}ngOnInit(){}onChartInit(o){this.echartsInstance=o}trackByPairAddress(o,n){return n.address}resizeChart(){this.echartsInstance&&this.echartsInstance.resize()}formatTokenValue(o,n){return(0,b.formatUnits)(o,n)}fetchHourData(o){return(0,A.z)(this.graphqlService.fetchHourData(o.address)).then(({data:n})=>{if(n.pair){const i=(n=(0,w.cloneDeep)(n)).pair.hourData.sort((a,s)=>parseInt(a.hourStartTime)-parseInt(s.hourStartTime)),l=i.length>0?(0,O.oC)(i.map(a=>parseInt(a.hourStartTime))[0]):[];let d;const p=l.map(a=>{let s=i.find(Q=>parseInt(Q.hourStartTime)==a);return s?d=s:s=d,s}),y=p.map(a=>this.formatTokenValue(a.price,o.token.decimals||"18")),u=p.map(a=>this.formatTokenValue(a.volume,o.token.decimals||"18")),g=(0,w.cloneDeep)(R);return g.series[0].data=y.map((a,s)=>[new Date(1e3*l[s]),a]),g.series[1].data=u.map((a,s)=>[new Date(1e3*l[s]),a]),g.tooltip.valueFormatter=a=>parseFloat(a).toFixed(2)+" "+o?.token.symbol,g}return R})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(M.Q),t.Y36(T.B),t.Y36(I.U),t.Y36(k.J))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-creator"]],decls:3,vars:3,consts:[[1,"creator-wrapper"],[4,"ngIf"],["class","creator-collection-card",4,"ngIf"],["class","creator-collection-card",4,"ngFor","ngForOf","ngForTrackBy"],[1,"creator-collection-card"],[1,"collection-no"],[1,"collection-info"],[1,"collection-logo"],[1,"logo-imgs"],["src","https://i.seadn.io/gae/Ju9CkWtV-1Okvf45wo8UctR-M9He2PjILP0oOvxE89AyiPPGtrR3gysu1Zgy0hjd2xKIgjJJtWIc0ybj4Vd7wv8t3pxDGHoJBzDB?auto=format&w=256",3,"alt"],[1,"collection-info-item-label"],[1,"collection-info-item-value"],[1,"revise-interval-btn",3,"routerLink"],[1,"revise-royalty-btn",3,"routerLink"],[1,"revise-royalty-reward-btn",3,"routerLink"],[1,"claim-royalty-btn",3,"click"],[1,"divider"],[2,"text-align","center"],["echarts","",1,"collection-chart",3,"options","chartInit"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0),t.YNc(1,L,3,3,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&o&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.creatorOfPairs$)))},dependencies:[f.sg,f.O5,m.rH,Z._w,f.Ov,f.JJ],styles:[".creator-wrapper[_ngcontent-%COMP%]{padding:12px 10%;width:100vw;box-sizing:border-box}.creator-collection-card[_ngcontent-%COMP%]{position:relative;background:#fff;padding:12px 24px;min-height:40vh;border-radius:8px;box-shadow:0 2px 4px -1px #0003;box-sizing:border-box;width:100%;margin-bottom:24px}.collection-no[_ngcontent-%COMP%]{width:36px;height:36px;display:flex;justify-content:center;align-items:center;position:absolute;right:12px;top:12px;font-size:24px;font-weight:bolder;color:#fff;border-radius:50%;background:linear-gradient(45deg,#f9d4af 0%,#ffb6db 100%)}.collection-info[_ngcontent-%COMP%]{width:90%;min-height:30vh;box-sizing:border-box;padding:12px;display:grid;grid-template-columns:360px 1fr 1fr 120px;grid-template-rows:1fr 1fr 1fr 1fr 1fr;column-gap:24px;align-items:center}.collection-logo[_ngcontent-%COMP%]{width:100%;grid-row-start:span 5;display:flex;justify-content:center;align-items:center;flex-direction:column}.collection-logo[_ngcontent-%COMP%]   .logo-imgs[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:row;margin-bottom:24px}.collection-logo[_ngcontent-%COMP%]   .logo-imgs[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{z-index:1}.collection-logo[_ngcontent-%COMP%]   .logo-imgs[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:180px;width:180px;margin:0 -12px;border-radius:50%;background:linear-gradient(180deg,#fceeff 0%,#fff5d4 100%);border:1px solid rgb(242,174,197)}.collection-info-item-label[_ngcontent-%COMP%]{grid-column-start:2;grid-column-end:3;padding-left:48px;font-size:18px;color:#680063}.collection-info-item-value[_ngcontent-%COMP%]{justify-self:end;font-size:18px;grid-column-start:3;grid-column-end:4}.revise-interval-btn[_ngcontent-%COMP%]{grid-row-start:2;grid-row-end:3}.revise-royalty-btn[_ngcontent-%COMP%]{grid-row-start:3;grid-row-end:4}.revise-royalty-reward-btn[_ngcontent-%COMP%]{grid-row-start:4;grid-row-end:5}.claim-royalty-btn[_ngcontent-%COMP%]{grid-row-start:5;grid-row-end:6}.revise-interval-btn[_ngcontent-%COMP%], .revise-royalty-reward-btn[_ngcontent-%COMP%], .revise-royalty-btn[_ngcontent-%COMP%], .claim-royalty-btn[_ngcontent-%COMP%]{grid-column-start:4;width:120px;height:36px;border-radius:16px;background:linear-gradient(45deg,#ffb6db 0%,#f9d4af 100%);color:#fff;font-size:14px;font-weight:bolder;display:flex;justify-content:center;align-items:center;transition:all .2s;cursor:pointer;z-index:1;border:none}.revise-interval-btn[_ngcontent-%COMP%]:hover, .revise-royalty-btn[_ngcontent-%COMP%]:hover, .revise-royalty-reward-btn[_ngcontent-%COMP%]:hover, .claim-royalty-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(45deg,#fda7d2 0%,#f8cda2 100%);color:#5a4c58}.divider[_ngcontent-%COMP%]{height:1px;width:100%;margin:8px 0 32px;background:linear-gradient(90deg,#f3b8ff 0%,#afeeff 100%)}.collection-chart[_ngcontent-%COMP%]{height:280px}"]}),e})();const R={tooltip:{trigger:"axis",position:function(e,c,o,n,i){return{top:0,right:"5%"}}},grid:{left:"5%",right:"5%",bottom:"15%",top:"25%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:[{type:"value",show:!1},{type:"value",show:!1}],series:[{name:"Price",yAxisIndex:0,type:"line",symbol:"none",sampling:"lttb",itemStyle:{color:"#ffb6db"},areaStyle:{color:new v.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#ffb6db"},{offset:1,color:"#f9d4af"}])},data:[]},{name:"Volume",type:"line",yAxisIndex:1,symbol:"none",sampling:"lttb",itemStyle:{color:"#de2aff"},areaStyle:{color:new v.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#de2aff"},{offset:1,color:"#81d8ff"}])},data:[]}]},F=[{path:"",component:j}];let B=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.Bz.forChild(F),m.Bz]}),e})();var D=r(83331),_=r(83114);let H=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[f.ez,B,_.H0,Z.Ns.forRoot({echarts:()=>Promise.resolve().then(r.bind(r,9375))}),D.Ps]}),e})()}}]);